;=====================================
; Minimal Dialplan for SIP Endpoint Model
; All call control handled by Genesys
;=====================================

[general]
static=yes
writeprotect=no
clearglobalvars=no

;=====================================
; Agent Context (From WebRTC Clients)
; Forward everything to Genesys
;=====================================

[genesys-agent]
; All calls from agents go directly to Genesys
; Genesys handles all routing logic

exten => _X.,1,NoOp(Agent ${CALLERID(num)} calling ${EXTEN})
 same => n,Set(CALLERID(name)=Agent ${CALLERID(num)})
 ; Forward to Genesys SIP Server
 same => n,Dial(PJSIP/${EXTEN}@genesys_sip_server,300)
 same => n,Hangup()

; Fallback
exten => i,1,NoOp(Invalid number dialed)
 same => n,Playback(invalid)
 same => n,Hangup()

exten => t,1,NoOp(Timeout)
 same => n,Hangup()

;=====================================
; From Genesys Context
; Incoming calls from Genesys to Agent DNs
;=====================================

[from-genesys]
; Calls from Genesys to agent DNs (5001-5999)

exten => _5XXX,1,NoOp(Call from Genesys to Agent DN ${EXTEN})
 same => n,Set(CALLERID(name)=${CALLERID(name)})
 same => n,Set(CALLERID(num)=${CALLERID(num)})
 ; Ring the WebRTC client
 same => n,Dial(PJSIP/${EXTEN},30)
 same => n,Hangup()

; Catch-all for any other number pattern
exten => _X.,1,NoOp(Call from Genesys to ${EXTEN})
 same => n,Dial(PJSIP/${EXTEN},30)
 same => n,Hangup()

; No answer
exten => h,1,NoOp(Call ended)
 same => n,Hangup()

;=====================================
; Notes:
; - No IVR - handled by Genesys
; - No queues - handled by Genesys
; - No voicemail - handled by Genesys
; - No transfers - handled by Genesys Workspace
; - No conferencing - handled by Genesys
; - Asterisk is just a SIP/WebRTC gateway
;=====================================




