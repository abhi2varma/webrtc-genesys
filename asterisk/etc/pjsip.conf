;=====================================
; PJSIP Configuration for WebRTC
;=====================================

[global]
type=global
max_forwards=70
keep_alive_interval=90
user_agent=Asterisk-WebRTC-PBX
default_outbound_endpoint=genesys_trunk

;=====================================
; Transport Configurations
;=====================================

; UDP Transport for traditional SIP
[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:5060
external_media_address=YOUR_PUBLIC_IP_HERE
external_signaling_address=YOUR_PUBLIC_IP_HERE
allow_reload=yes

; TCP Transport
[transport-tcp]
type=transport
protocol=tcp
bind=0.0.0.0:5061

; WebSocket Transport for WebRTC (unencrypted - for testing only)
[transport-ws]
type=transport
protocol=ws
bind=0.0.0.0:8088

; WebSocket Secure Transport for WebRTC (production)
[transport-wss]
type=transport
protocol=wss
bind=0.0.0.0:8089
cert_file=/etc/certs/cert.pem
priv_key_file=/etc/certs/key.pem
ca_list_file=/etc/certs/ca.pem

;=====================================
; Genesys SIP Trunk Configuration
;=====================================

[genesys_trunk]
type=endpoint
context=from-genesys
transport=transport-udp
aors=genesys_trunk
outbound_auth=genesys_auth
disallow=all
allow=ulaw,alaw,g722,opus
from_user=YOUR_GENESYS_USERNAME
force_rport=yes
direct_media=no
ice_support=no
dtmf_mode=rfc4733
rtp_symmetric=yes
rewrite_contact=yes
send_rpid=yes
send_pai=yes

[genesys_trunk]
type=aor
contact=sip:GENESYS_SIP_HOST:5060
qualify_frequency=60

[genesys_auth]
type=auth
auth_type=userpass
username=YOUR_GENESYS_USERNAME
password=YOUR_GENESYS_PASSWORD

[genesys-identify]
type=identify
endpoint=genesys_trunk
match=GENESYS_SIP_HOST

;=====================================
; WebRTC Client Template
;=====================================

[webrtc_client](!)
type=endpoint
transport=transport-ws,transport-wss
context=from-internal
disallow=all
allow=opus,ulaw,alaw
webrtc=yes
ice_support=yes
use_avpf=yes
media_encryption=dtls
dtls_verify=fingerprint
dtls_rekey=0
dtls_cert_file=/etc/certs/cert.pem
dtls_private_key=/etc/certs/key.pem
dtls_ca_file=/etc/certs/ca.pem
dtls_setup=actpass
rtcp_mux=yes
use_ptime=yes
force_rport=yes
rewrite_contact=yes
direct_media=no
rtp_symmetric=yes
force_avp=yes
media_use_received_transport=yes

[webrtc_auth](!)
type=auth
auth_type=userpass

[webrtc_aor](!)
type=aor
max_contacts=5
remove_existing=yes
qualify_frequency=30

;=====================================
; WebRTC User Accounts
;=====================================

[1000](webrtc_client)
type=endpoint
auth=1000
aors=1000
callerid="WebRTC User 1000" <1000>

[1000](webrtc_auth)
type=auth
password=webrtc1000pass
username=1000

[1000](webrtc_aor)
type=aor

[1001](webrtc_client)
type=endpoint
auth=1001
aors=1001
callerid="WebRTC User 1001" <1001>

[1001](webrtc_auth)
type=auth
password=webrtc1001pass
username=1001

[1001](webrtc_aor)
type=aor

[1002](webrtc_client)
type=endpoint
auth=1002
aors=1002
callerid="WebRTC User 1002" <1002>

[1002](webrtc_auth)
type=auth
password=webrtc1002pass
username=1002

[1002](webrtc_aor)
type=aor

;=====================================
; Kamailio Integration
;=====================================

[kamailio]
type=endpoint
transport=transport-udp
context=from-kamailio
aors=kamailio
disallow=all
allow=ulaw,alaw,g722,opus
direct_media=no
ice_support=yes
force_rport=yes
rtp_symmetric=yes

[kamailio]
type=aor
contact=sip:127.0.0.1:5060
qualify_frequency=60

[kamailio-identify]
type=identify
endpoint=kamailio
match=127.0.0.1




