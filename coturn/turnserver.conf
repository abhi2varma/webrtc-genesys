# TURN Server Configuration for WebRTC

# Listening port for TURN (UDP only to force Asterisk to use UDP)
listening-port=3478
tls-listening-port=5349

# Force UDP only - disable TCP completely for TURN
# This forces Asterisk (which defaults to TCP) to use UDP instead
no-tcp-relay
no-tcp
no-tls

# Listening IP (bind to all interfaces)
listening-ip=0.0.0.0

# Also explicitly listen for UDP STUN
listening-ip=192.168.210.54

# Relay IP (should be your actual server IP, not public IP)
relay-ip=192.168.210.54

# External IP (format: external-ip=PUBLIC_IP/INTERNAL_IP)
external-ip=103.167.180.166/192.168.210.54

# TURN server realm
realm=webrtc.genesys.local

# Server name
server-name=coturn-genesys

# Use fingerprints in TURN messages
fingerprint

# AUTHENTICATION DISABLED FOR POC
# Asterisk's TURN client doesn't properly send credentials
# For production, enable authentication and fix Asterisk configuration
# lt-cred-mech
# user=webrtc:Genesys2024!SecureTurn

# Total quota per user
total-quota=100
bps-capacity=0

# Max port for relay (aligned with firewall POC allocation)
# Network team allocated: 10000-10100 UDP for POC testing (~25-50 concurrent calls)
# Must match firewall rules: 10000-10100
max-port=10100
min-port=10000

# Log file (with rotation)
log-file=/var/log/coturn/turnserver.log
log-file-size-limit=10485760
verbose

# Certificate for TLS
cert=/etc/certs/cert.pem
pkey=/etc/certs/key.pem

# No multicast
no-multicast-peers

# Allow loopback for testing (needed for local network testing)
# no-loopback-peers

# Security options
no-tlsv1
no-tlsv1_1
cipher-list="ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384"

# Mobility
mobility

# Allow loopback for testing (remove in production)
# no-loopback-peers

# Process details - commented out to avoid permission errors in Docker
# Container will run as default user
#proc-user=root
#proc-group=root




