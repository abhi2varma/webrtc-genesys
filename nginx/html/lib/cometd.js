(function (require, requirejs, define) {
this.org=this.org||{},org.cometd={},org.cometd.JSON={},org.cometd.JSON.toJSON=org.cometd.JSON.fromJSON=function(e){throw"Abstract"},org.cometd.Utils={},org.cometd.Utils.isString=function(e){return e===undefined||e===null?!1:typeof e=="string"||e instanceof String},org.cometd.Utils.isArray=function(e){return e===undefined||e===null?!1:e instanceof Array},org.cometd.Utils.inArray=function(e,t){for(var n=0;n<t.length;++n)if(e===t[n])return n;return-1},org.cometd.Utils.setTimeout=function(e,t,n){return window.setTimeout(function(){try{e._debug("Invoking timed function",t),t()}catch(n){e._debug("Exception invoking timed function",t,n)}},n)},org.cometd.Utils.clearTimeout=function(e){window.clearTimeout(e)},org.cometd.TransportRegistry=function(){var e=[],t={};this.getTransportTypes=function(){return e.slice(0)},this.findTransportTypes=function(n,r,i){var s=[];for(var o=0;o<e.length;++o){var u=e[o];t[u].accept(n,r,i)===!0&&s.push(u)}return s},this.negotiateTransport=function(n,r,i,s){for(var o=0;o<e.length;++o){var u=e[o];for(var a=0;a<n.length;++a)if(u===n[a]){var f=t[u];if(f.accept(r,i,s)===!0)return f}}return null},this.add=function(n,r,i){var s=!1;for(var o=0;o<e.length;++o)if(e[o]===n){s=!0;break}return s||(typeof i!="number"?e.push(n):e.splice(i,0,n),t[n]=r),!s},this.find=function(n){for(var r=0;r<e.length;++r)if(e[r]===n)return t[n];return null},this.remove=function(n){for(var r=0;r<e.length;++r)if(e[r]===n){e.splice(r,1);var i=t[n];return delete t[n],i}return null},this.clear=function(){e=[],t={}},this.reset=function(){for(var n=0;n<e.length;++n)t[e[n]].reset()}},org.cometd.Transport=function(){var e,t;this.registered=function(n,r){e=n,t=r},this.unregistered=function(){e=null,t=null},this._debug=function(){t._debug.apply(t,arguments)},this._mixin=function(){return t._mixin.apply(t,arguments)},this.getConfiguration=function(){return t.getConfiguration()},this.getAdvice=function(){return t.getAdvice()},this.setTimeout=function(e,n){return org.cometd.Utils.setTimeout(t,e,n)},this.clearTimeout=function(e){org.cometd.Utils.clearTimeout(e)},this.convertToMessages=function(e){if(org.cometd.Utils.isString(e))try{return org.cometd.JSON.fromJSON(e)}catch(t){throw this._debug("Could not convert to JSON the following string",'"'+e+'"'),t}if(org.cometd.Utils.isArray(e))return e;if(e===undefined||e===null)return[];if(e instanceof Object)return[e];throw"Conversion Error "+e+", typeof "+typeof e},this.accept=function(e,t,n){throw"Abstract"},this.getType=function(){return e},this.send=function(e,t){throw"Abstract"},this.reset=function(){this._debug("Transport",e,"reset")},this.abort=function(){this._debug("Transport",e,"aborted")},this.toString=function(){return this.getType()}},org.cometd.Transport.derive=function(e){function t(){}return t.prototype=e,new t},org.cometd.RequestTransport=function(){function o(e){while(s.length>0){var t=s[0],n=t[0],r=t[1];if(n.url===e.url&&n.sync===e.sync){s.shift(),e.messages=e.messages.concat(n.messages),this._debug("Coalesced",n.messages.length,"messages from request",r.id);continue}break}}function u(e,t){this.transportSend(e,t),t.expired=!1;if(!e.sync){var n=this.getConfiguration().maxNetworkDelay,r=n;t.metaConnect===!0&&(r+=this.getAdvice().timeout),this._debug("Transport",this.getType(),"waiting at most",r,"ms for the response, maxNetworkDelay",n);var i=this;t.timeout=this.setTimeout(function(){t.expired=!0;var n="Request "+t.id+" of transport "+i.getType()+" exceeded "+r+" ms max network delay",s={reason:n},o=t.xhr;s.httpCode=i.xhrStatus(o),i.abortXHR(o),i._debug(n),i.complete(t,!1,t.metaConnect),e.onFailure(o,e.messages,s)},r)}}function a(e){var t=++n,r={id:t,metaConnect:!1};i.length<this.getConfiguration().maxConnections-1?(i.push(r),u.call(this,e,r)):(this._debug("Transport",this.getType(),"queueing request",t,"envelope",e),s.push([e,r]))}function f(e){var t=e.id;this._debug("Transport",this.getType(),"metaConnect complete, request",t);if(r!==null&&r.id!==t)throw"Longpoll request mismatch, completing request "+t;r=null}function l(e,t){var n=org.cometd.Utils.inArray(e,i);n>=0&&i.splice(n,1);if(s.length>0){var r=s.shift(),u=r[0],f=r[1];this._debug("Transport dequeued request",f.id);if(t)this.getConfiguration().autoBatch&&o.call(this,u),a.call(this,u),this._debug("Transport completed request",e.id,u);else{var l=this;this.setTimeout(function(){l.complete(f,!1,f.metaConnect);var e={reason:"Previous request failed"},t=f.xhr;e.httpCode=l.xhrStatus(t),u.onFailure(t,u.messages,e)},0)}}}function c(e){if(r!==null)throw"Concurrent metaConnect requests not allowed, request id="+r.id+" not yet completed";var t=++n;this._debug("Transport",this.getType(),"metaConnect send, request",t,"envelope",e);var i={id:t,metaConnect:!0};u.call(this,e,i),r=i}var e=new org.cometd.Transport,t=org.cometd.Transport.derive(e),n=0,r=null,i=[],s=[];return t.complete=function(e,t,n){n?f.call(this,e):l.call(this,e,t)},t.transportSend=function(e,t){throw"Abstract"},t.transportSuccess=function(e,t,n){t.expired||(this.clearTimeout(t.timeout),this.complete(t,!0,t.metaConnect),n&&n.length>0?e.onSuccess(n):e.onFailure(t.xhr,e.messages,{httpCode:204}))},t.transportFailure=function(e,t,n){t.expired||(this.clearTimeout(t.timeout),this.complete(t,!1,t.metaConnect),e.onFailure(t.xhr,e.messages,n))},t.send=function(e,t){t?c.call(this,e):a.call(this,e)},t.abort=function(){e.abort();for(var t=0;t<i.length;++t){var n=i[t];this._debug("Aborting request",n),this.abortXHR(n.xhr)}r&&(this._debug("Aborting metaConnect request",r),this.abortXHR(r.xhr)),this.reset()},t.reset=function(){e.reset(),r=null,i=[],s=[]},t.abortXHR=function(e){if(e)try{e.abort()}catch(t){this._debug(t)}},t.xhrStatus=function(e){if(e)try{return e.status}catch(t){this._debug(t)}return-1},t},org.cometd.LongPollingTransport=function(){var e=new org.cometd.RequestTransport,t=org.cometd.Transport.derive(e),n=!0;return t.accept=function(e,t,r){return n||!t},t.xhrSend=function(e){throw"Abstract"},t.transportSend=function(e,t){this._debug("Transport",this.getType(),"sending request",t.id,"envelope",e);var r=this;try{var i=!0;t.xhr=this.xhrSend({transport:this,url:e.url,sync:e.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(e.messages),onSuccess:function(i){r._debug("Transport",r.getType(),"received response",i);var s=!1;try{var o=r.convertToMessages(i);o.length===0?(n=!1,r.transportFailure(e,t,{httpCode:204})):(s=!0,r.transportSuccess(e,t,o))}catch(u){r._debug(u);if(!s){n=!1;var a={exception:u};a.httpCode=r.xhrStatus(t.xhr),r.transportFailure(e,t,a)}}},onError:function(s,o){n=!1;var u={reason:s,exception:o};u.httpCode=r.xhrStatus(t.xhr),i?r.setTimeout(function(){r.transportFailure(e,t,u)},0):r.transportFailure(e,t,u)}}),i=!1}catch(s){n=!1,this.setTimeout(function(){r.transportFailure(e,t,{exception:s})},0)}},t.reset=function(){e.reset(),n=!0},t},org.cometd.CallbackPollingTransport=function(){function r(e,t,n){var r=this;return function(){r.transportFailure(e,t,"error",n)}}var e=new org.cometd.RequestTransport,t=org.cometd.Transport.derive(e),n=2e3;return t.accept=function(e,t,n){return!0},t.jsonpSend=function(e){throw"Abstract"},t.transportSend=function(e,t){var i=this,s=0,o=e.messages.length,u=[];while(o>0){var a=org.cometd.JSON.toJSON(e.messages.slice(s,s+o)),f=e.url.length+encodeURI(a).length;if(f>n){if(o===1){var l="Bayeux message too big ("+f+" bytes, max is "+n+") "+"for transport "+this.getType();this.setTimeout(r.call(this,e,t,l),0);return}--o;continue}u.push(o),s+=o,o=e.messages.length-s}var c=e;if(u.length>1){var h=0,p=u[0];this._debug("Transport",this.getType(),"split",e.messages.length,"messages into",u.join(" + ")),c=this._mixin(!1,{},e),c.messages=e.messages.slice(h,p),c.onSuccess=e.onSuccess,c.onFailure=e.onFailure;for(var d=1;d<u.length;++d){var v=this._mixin(!1,{},e);h=p,p+=u[d],v.messages=e.messages.slice(h,p),v.onSuccess=e.onSuccess,v.onFailure=e.onFailure,this.send(v,t.metaConnect)}}this._debug("Transport",this.getType(),"sending request",t.id,"envelope",c);try{var m=!0;this.jsonpSend({transport:this,url:c.url,sync:c.sync,headers:this.getConfiguration().requestHeaders,body:org.cometd.JSON.toJSON(c.messages),onSuccess:function(e){var n=!1;try{var r=i.convertToMessages(e);r.length===0?i.transportFailure(c,t,{httpCode:204}):(n=!0,i.transportSuccess(c,t,r))}catch(s){i._debug(s),n||i.transportFailure(c,t,{exception:s})}},onError:function(e,n){var r={reason:e,exception:n};m?i.setTimeout(function(){i.transportFailure(c,t,r)},0):i.transportFailure(c,t,r)}}),m=!1}catch(g){this.setTimeout(function(){i.transportFailure(c,t,{exception:g})},0)}},t},org.cometd.WebSocketTransport=function(){function h(){if(a)return;a=!0;var e=n.getURL().replace(/^http/,"ws");this._debug("Transport",this.getType(),"connecting to URL",e);try{var t=n.getConfiguration().protocol,i=t?new org.cometd.WebSocket(e,t):new org.cometd.WebSocket(e)}catch(o){throw r=!1,this._debug("Exception while creating WebSocket object",o),o}s=n.getConfiguration().stickyReconnect!==!1;var u=this,l=null,c=n.getConfiguration().connectTimeout;c>0&&(l=this.setTimeout(function(){l=null,u._debug("Transport",u.getType(),"timed out while connecting to URL",e,":",c,"ms");var t={code:1e3,reason:"Connect Timeout"};u.webSocketClose(i,t.code,t.reason),u.onClose(i,t)},c));var h=function(){u._debug("WebSocket opened",i),a=!1,l&&(u.clearTimeout(l),l=null),f?(n._warn("Closing Extra WebSocket Connections",i,f),u.webSocketClose(i,1e3,"Extra Connection")):u.onOpen(i)},p=function(e){e=e||{code:1e3},u._debug("WebSocket closing",i,e),a=!1,l&&(u.clearTimeout(l),l=null),f!==null&&i!==f?u._debug("Closed Extra WebSocket Connection",i):u.onClose(i,e)},d=function(e){u._debug("WebSocket message",e,i),i!==f&&n._warn("Extra WebSocket Connections",i,f),u.onMessage(i,e)};i.onopen=h,i.onclose=p,i.onerror=function(){p({code:1002,reason:"Error"})},i.onmessage=d,this._debug("Transport",this.getType(),"configured callbacks on",i)}function p(e,t,n){var r=org.cometd.JSON.toJSON(t.messages);e.send(r),this._debug("Transport",this.getType(),"sent",t,"metaConnect =",n);var i=this.getConfiguration().maxNetworkDelay,s=i;n&&(s+=this.getAdvice().timeout,l=!0);var o=this,a=[];for(var f=0;f<t.messages.length;++f)(function(){var n=t.messages[f];n.id&&(a.push(n.id),u[n.id]=this.setTimeout(function(){o._debug("Transport",o.getType(),"timing out message",n.id,"after",s,"on",e);var t={code:1e3,reason:"Message Timeout"};o.webSocketClose(e,t.code,t.reason),o.onClose(e,t)},s))})();this._debug("Transport",this.getType(),"waiting at most",s,"ms for messages",a,"maxNetworkDelay",i,", timeouts:",u)}function d(e,t,n){try{e===null?h.call(this):p.call(this,e,t,n)}catch(r){this.setTimeout(function(){t.onFailure(e,t.messages,{exception:r})},0)}}var e=new org.cometd.Transport,t=org.cometd.Transport.derive(e),n,r=!0,i=!1,s=!0,o={},u={},a=!1,f=null,l=!1,c=null;return t.reset=function(){e.reset(),r=!0,i=!1,s=!0,o={},u={},a=!1,f=null,l=!1,c=null},t.onOpen=function(e){this._debug("Transport",this.getType(),"opened",e),f=e,i=!0,this._debug("Sending pending messages",o);for(var t in o){var n=o[t],r=n[0],s=n[1];c=r.onSuccess,p.call(this,e,r,s)}},t.onMessage=function(e,t){this._debug("Transport",this.getType(),"received websocket message",t,e);var n=!1,r=this.convertToMessages(t.data),i=[];for(var s=0;s<r.length;++s){var a=r[s];if(/^\/meta\//.test(a.channel)||a.successful!==undefined)if(a.id){i.push(a.id);var f=u[a.id];f&&(this.clearTimeout(f),delete u[a.id],this._debug("Transport",this.getType(),"removed timeout for message",a.id,", timeouts",u))}"/meta/connect"===a.channel&&(l=!1),"/meta/disconnect"===a.channel&&!l&&(n=!0)}var h=!1;for(var p=0;p<i.length;++p){var d=i[p];for(var v in o){var m=v.split(","),g=org.cometd.Utils.inArray(d,m);if(g>=0){h=!0,m.splice(g,1);var y=o[v][0],b=o[v][1];delete o[v],m.length>0&&(o[m.join(",")]=[y,b]);break}}}h&&this._debug("Transport",this.getType(),"removed envelope, envelopes",o),c.call(this,r),n&&this.webSocketClose(e,1e3,"Disconnect")},t.onClose=function(e,t){this._debug("Transport",this.getType(),"closed",e,t),r=s&&i;var n=u;u={};for(var a in n)this.clearTimeout(n[a]);var c=o;o={};for(var h in c){var p=c[h][0],d=c[h][1];d&&(l=!1),p.onFailure(e,p.messages,{websocketCode:t.code,reason:t.reason})}f=null},t.registered=function(t,r){e.registered(t,r),n=r},t.accept=function(e,t,i){return r&&!!org.cometd.WebSocket&&n.websocketEnabled!==!1},t.send=function(e,t){this._debug("Transport",this.getType(),"sending",e,"metaConnect =",t);var n=[];for(var r=0;r<e.messages.length;++r){var i=e.messages[r];i.id&&n.push(i.id)}o[n.join(",")]=[e,t],this._debug("Transport",this.getType(),"stored envelope, envelopes",o),d.call(this,f,e,t)},t.webSocketClose=function(e,t,n){try{e.close(t,n)}catch(r){this._debug(r)}},t.abort=function(){e.abort();if(f){var t={code:1001,reason:"Abort"};this.webSocketClose(f,t.code,t.reason),this.onClose(f,t)}this.reset()},t},org.cometd.CometD=function(e){function x(e,t){try{return e[t]}catch(n){return undefined}}function T(e){return org.cometd.Utils.isString(e)}function N(e){return e===undefined||e===null?!1:typeof e=="function"}function C(e,t){if(window.console){var n=window.console[e];N(n)&&n.apply(window.console,t)}}function k(e){t._debug("Configuring cometd object with",e),T(e)&&(e={url:e}),e||(e={}),S=t._mixin(!1,S,e);var n=t.getURL();if(!n)throw"Missing required configuration parameter 'url' specifying the Bayeux server URL";var i=/(^https?:\/\/)?(((\[[^\]]+\])|([^:\/\?#]+))(:(\d+))?)?([^\?#]*)(.*)?/.exec(n),s=i[2],o=i[8],u=i[9];r=t._isCrossDomain(s);if(S.appendMessageTypeToURL)if(u!==undefined&&u.length>0)t._info("Appending message type to URI "+o+u+" is not supported, disabling 'appendMessageTypeToURL' configuration"),S.appendMessageTypeToURL=!1;else{var a=o.split("/"),f=a.length-1;o.match(/\/$/)&&(f-=1),a[f].indexOf(".")>=0&&(t._info("Appending message type to URI "+o+" is not supported, disabling 'appendMessageTypeToURL' configuration"),S.appendMessageTypeToURL=!1)}}function L(e){if(e){var n=h[e.channel];n&&n[e.id]&&(delete n[e.id],t._debug("Removed",e.listener?"listener":"subscription",e))}}function A(e){e&&!e.listener&&L(e)}function O(){for(var e in h){var t=h[e];if(t)for(var n=0;n<t.length;++n)A(t[n])}}function M(e){o!==e&&(t._debug("Status",o,"->",e),o=e)}function _(){return o==="disconnecting"||o==="disconnected"}function D(){return++u}function P(e,n,r,i,s){try{return n.call(e,i)}catch(o){t._debug("Exception during execution of extension",r,o);var u=t.onExtensionException;if(N(u)){t._debug("Invoking extension exception callback",r,o);try{u.call(t,o,r,s,i)}catch(a){t._info("Exception during execution of exception callback in extension",r,a)}}return i}}function H(e){for(var t=0;t<v.length;++t){if(e===undefined||e===null)break;var n=S.reverseIncomingExtensions?v.length-1-t:t,r=v[n],i=r.extension.incoming;if(N(i)){var s=P(r.extension,i,r.name,e,!1);e=s===undefined?e:s}}return e}function B(e){for(var t=0;t<v.length;++t){if(e===undefined||e===null)break;var n=v[t],r=n.extension.outgoing;if(N(r)){var i=P(n.extension,r,n.name,e,!0);e=i===undefined?e:i}}return e}function j(e,n){var r=h[e];if(r&&r.length>0)for(var i=0;i<r.length;++i){var s=r[i];if(s)try{s.callback.call(s.scope,n)}catch(o){t._debug("Exception during notification",s,n,o);var u=t.onListenerException;if(N(u)){t._debug("Invoking listener exception callback",s,o);try{u.call(t,o,s,s.listener,n)}catch(a){t._info("Exception during execution of listener callback",s,a)}}}}}function F(e,t){j(e,t);var n=e.split("/"),r=n.length-1;for(var i=r;i>0;--i){var s=n.slice(0,i).join("/")+"/*";i===r&&j(s,t),s+="*",j(s,t)}}function I(){d!==null&&org.cometd.Utils.clearTimeout(d),d=null}function q(e){I();var n=m.interval+p;t._debug("Function scheduled in",n,"ms, interval =",m.interval,"backoff =",p,e),d=org.cometd.Utils.setTimeout(t,e,n)}function z(e,n,r,i){for(var o=0;o<n.length;++o){var u=n[o],f=""+D();u.id=f,a&&(u.clientId=a);var l=undefined;N(u._callback)&&(l=u._callback,delete u._callback),u=B(u),u!==undefined&&u!==null?(u.id=f,n[o]=u,l&&(b[f]=l)):n.splice(o--,1)}if(n.length===0)return;var c=t.getURL();S.appendMessageTypeToURL&&(c.match(/\/$/)||(c+="/"),i&&(c+=i));var h={url:c,sync:e,messages:n,onSuccess:function(e){try{R.call(t,e)}catch(n){t._debug("Exception during handling of messages",n)}},onFailure:function(e,n,r){try{var i=t.getTransport();r.connectionType=i?i.getType():"unknown",U.call(t,e,n,r)}catch(s){t._debug("Exception during handling of failure",s)}}};t._debug("Send",h),s.send(h,r)}function W(e){f>0||c===!0?l.push(e):z(!1,[e],!1)}function X(){p=0}function V(){p<S.maxBackoff&&(p+=S.backoffIncrement)}function $(){++f}function J(){var e=l;l=[],e.length>0&&z(!1,e,!1)}function K(){--f;if(f<0)throw"Calls to startBatch() and endBatch() are not paired";f===0&&!_()&&!c&&J()}function Q(){if(!_()){var e={channel:"/meta/connect",connectionType:s.getType()};E||(e.advice={timeout:0}),M("connecting"),t._debug("Connect sent",e),z(!1,[e],!0,"connect"),M("connected")}}function G(){M("connecting"),q(function(){Q()})}function Y(e){e&&(m=t._mixin(!1,{},S.advice,e),t._debug("New advice",m))}function Z(e){I(),e&&s&&s.abort(),a=null,M("disconnected"),f=0,X(),s=null;if(l.length>0){var n=l;l=[],U.call(t,undefined,n,{reason:"Disconnected"})}}function et(e,n,r){var i=t.onTransportFailure;if(N(i)){t._debug("Invoking transport failure callback",e,n,r);try{i.call(t,e,n,r)}catch(s){t._info("Exception during execution of transport failure callback",s)}}}function tt(e,n){N(e)&&(n=e,e=undefined),a=null,O(),_()?(i.reset(),Y(S.advice)):Y(t._mixin(!1,m,{reconnect:"retry"})),f=0,c=!0,g=e,y=n;var o="1.0",u=t.getURL(),l=i.findTransportTypes(o,r,u),h={version:o,minimumVersion:o,channel:"/meta/handshake",supportedConnectionTypes:l,_callback:n,advice:{timeout:m.timeout,interval:m.interval}},p=t._mixin(!1,{},g,h);if(!s){s=i.negotiateTransport(l,o,r,u);if(!s){var d="Could not find initial transport among: "+i.getTransportTypes();throw t._warn(d),d}}t._debug("Initial transport is",s.getType()),M("handshaking"),t._debug("Handshake sent",p),z(!1,[p],!1,"handshake")}function nt(){M("handshaking"),c=!0,q(function(){tt(g,y)})}function rt(e){var n=b[e.id];N(n)&&(delete b[e.id],n.call(t,e))}function it(e){rt(e),F("/meta/handshake",e),F("/meta/unsuccessful",e);var t=!_()&&m.reconnect!=="none";t?(V(),nt()):Z(!1)}function st(e){if(e.successful){a=e.clientId;var n=t.getURL(),o=i.negotiateTransport(e.supportedConnectionTypes,e.version,r,n);if(o===null){var u="Could not negotiate transport with server; client=["+i.findTransportTypes(e.version,r,n)+"], server=["+e.supportedConnectionTypes+"]",f=t.getTransport();et(f.getType(),null,{reason:u,connectionType:f.getType(),transport:f}),t._warn(u),Z(!0);return}s!==o&&(t._debug("Transport",s.getType(),"->",o.getType()),s=o),c=!1,J(),e.reestablish=w,w=!0,rt(e),F("/meta/handshake",e);var l=_()?"none":m.reconnect;switch(l){case"retry":X(),G();break;case"none":Z(!1);break;default:throw"Unrecognized advice action "+l}}else it(e)}function ot(e){var n="1.0",o=t.getURL(),u=t.getTransport(),a=i.findTransportTypes(n,r,o),f=i.negotiateTransport(a,n,r,o);f?(t._debug("Transport",u.getType(),"->",f.getType()),et(u.getType(),f.getType(),e.failure),it(e),s=f):(et(u.getType(),null,e.failure),t._warn("Could not negotiate transport; client=["+a+"]"),Z(!0),it(e))}function ut(e){F("/meta/connect",e),F("/meta/unsuccessful",e);var t=_()?"none":m.reconnect;switch(t){case"retry":G(),V();break;case"handshake":i.reset(),X(),nt();break;case"none":Z(!1);break;default:throw"Unrecognized advice action"+t}}function at(e){E=e.successful;if(E){F("/meta/connect",e);var t=_()?"none":m.reconnect;switch(t){case"retry":X(),G();break;case"none":Z(!1);break;default:throw"Unrecognized advice action "+t}}else ut(e)}function ft(e){E=!1,ut(e)}function lt(e){Z(!0),rt(e),F("/meta/disconnect",e),F("/meta/unsuccessful",e)}function ct(e){e.successful?(Z(!1),rt(e),F("/meta/disconnect",e)):lt(e)}function ht(e){lt(e)}function pt(e){var n=h[e.subscription];if(n)for(var r=n.length-1;r>=0;--r){var i=n[r];if(i&&!i.listener){delete n[r],t._debug("Removed failed subscription",i);break}}rt(e),F("/meta/subscribe",e),F("/meta/unsuccessful",e)}function dt(e){e.successful?(rt(e),F("/meta/subscribe",e)):pt(e)}function vt(e){pt(e)}function mt(e){rt(e),F("/meta/unsubscribe",e),F("/meta/unsuccessful",e)}function gt(e){e.successful?(rt(e),F("/meta/unsubscribe",e)):mt(e)}function yt(e){mt(e)}function bt(e){rt(e),F("/meta/publish",e),F("/meta/unsuccessful",e)}function wt(e){e.successful===undefined?e.data!==undefined?F(e.channel,e):t._warn("Unknown Bayeux Message",e):e.successful?(rt(e),F("/meta/publish",e)):bt(e)}function Et(e){bt(e)}function St(e){e=H(e);if(e===undefined||e===null)return;Y(e.advice);var t=e.channel;switch(t){case"/meta/handshake":st(e);break;case"/meta/connect":at(e);break;case"/meta/disconnect":ct(e);break;case"/meta/subscribe":dt(e);break;case"/meta/unsubscribe":gt(e);break;default:wt(e)}}function xt(e){var t=h[e];if(t)for(var n=0;n<t.length;++n)if(t[n])return!0;return!1}function Tt(e,t){var n={scope:e,method:t};if(N(e))n.scope=undefined,n.method=e;else if(T(t)){if(!e)throw"Invalid scope "+e;n.method=e[t];if(!N(n.method))throw"Invalid callback "+t+" for scope "+e}else if(!N(t))throw"Invalid callback "+t;return n}function Nt(e,n,r,i){var s=Tt(n,r);t._debug("Adding",i?"listener":"subscription","on",e,"with scope",s.scope,"and callback",s.method);var o={channel:e,scope:s.scope,callback:s.method,listener:i},u=h[e];return u||(u=[],h[e]=u),o.id=u.push(o)-1,t._debug("Added",i?"listener":"subscription",o),o[0]=e,o[1]=o.id,o}var t=this,n=e||"default",r=!1,i=new org.cometd.TransportRegistry,s,o="disconnected",u=0,a=null,f=0,l=[],c=!1,h={},p=0,d=null,v=[],m={},g,y,b={},w=!1,E=!1,S={protocol:null,stickyReconnect:!0,connectTimeout:0,maxConnections:2,backoffIncrement:1e3,maxBackoff:6e4,logLevel:"info",reverseIncomingExtensions:!0,maxNetworkDelay:1e4,requestHeaders:{},appendMessageTypeToURL:!0,autoBatch:!1,advice:{timeout:6e4,interval:0,reconnect:"retry"}};this._mixin=function(e,t,n){var r=t||{};for(var i=2;i<arguments.length;++i){var s=arguments[i];if(s===undefined||s===null)continue;for(var o in s){var u=x(s,o),a=x(r,o);if(u===t)continue;if(u===undefined)continue;if(e&&typeof u=="object"&&u!==null)if(u instanceof Array)r[o]=this._mixin(e,a instanceof Array?a:[],u);else{var f=typeof a!="object"||a instanceof Array?{}:a;r[o]=this._mixin(e,f,u)}else r[o]=u}}return r},this._warn=function(){C("warn",arguments)},this._info=function(){S.logLevel!=="warn"&&C("info",arguments)},this._debug=function(){S.logLevel==="debug"&&C("debug",arguments)},this._isCrossDomain=function(e){return e&&e!==window.location.host};var R,U;this.send=W,this.receive=St,R=function(e){t._debug("Received",e);for(var n=0;n<e.length;++n){var r=e[n];St(r)}},U=function(e,n,r){t._debug("handleFailure",e,n,r),r.transport=e;for(var i=0;i<n.length;++i){var s=n[i],o={id:s.id,successful:!1,channel:s.channel,failure:r};r.message=s;switch(s.channel){case"/meta/handshake":ot(o);break;case"/meta/connect":ft(o);break;case"/meta/disconnect":ht(o);break;case"/meta/subscribe":o.subscription=s.subscription,vt(o);break;case"/meta/unsubscribe":o.subscription=s.subscription,yt(o);break;default:Et(o)}}},this.registerTransport=function(e,t,n){var r=i.add(e,t,n);return r&&(this._debug("Registered transport",e),N(t.registered)&&t.registered(e,this)),r},this.getTransportTypes=function(){return i.getTransportTypes()},this.unregisterTransport=function(e){var t=i.remove(e);return t!==null&&(this._debug("Unregistered transport",e),N(t.unregistered)&&t.unregistered()),t},this.unregisterTransports=function(){i.clear()},this.findTransport=function(e){return i.find(e)},this.configure=function(e){k.call(this,e)},this.init=function(e,t){this.configure(e),this.handshake(t)},this.handshake=function(e,t){M("disconnected"),w=!1,tt(e,t)},this.disconnect=function(e,t,n){if(_())return;typeof e!="boolean"&&(n=t,t=e,e=!1),N(t)&&(n=t,t=undefined);var r={channel:"/meta/disconnect",_callback:n},i=this._mixin(!1,{},t,r);M("disconnecting"),z(e===!0,[i],!1,"disconnect")},this.startBatch=function(){$()},this.endBatch=function(){K()},this.batch=function(e,t){var n=Tt(e,t);this.startBatch();try{n.method.call(n.scope),this.endBatch()}catch(r){throw this._info("Exception during execution of batch",r),this.endBatch(),r}},this.addListener=function(e,t,n){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!T(e))throw"Illegal argument type: channel must be a string";return Nt(e,t,n,!0)},this.removeListener=function(e){if(!e||!e.channel||!("id"in e))throw"Invalid argument: expected subscription, not "+e;L(e)},this.clearListeners=function(){h={}},this.subscribe=function(e,t,n,r,i){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!T(e))throw"Illegal argument type: channel must be a string";if(_())throw"Illegal state: already disconnected";N(t)&&(i=r,r=n,n=t,t=undefined),N(r)&&(i=r,r=undefined);var s=!xt(e),o=Nt(e,t,n,!1);if(s){var u={channel:"/meta/subscribe",subscription:e,_callback:i},a=this._mixin(!1,{},r,u);W(a)}return o},this.unsubscribe=function(e,t,n){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(_())throw"Illegal state: already disconnected";N(t)&&(n=t,t=undefined),this.removeListener(e);var r=e.channel;if(!xt(r)){var i={channel:"/meta/unsubscribe",subscription:r,_callback:n},s=this._mixin(!1,{},t,i);W(s)}},this.resubscribe=function(e,t){return A(e),e?this.subscribe(e.channel,e.scope,e.callback,t):undefined},this.clearSubscriptions=function(){O()},this.publish=function(e,t,n,r){if(arguments.length<1)throw"Illegal arguments number: required 1, got "+arguments.length;if(!T(e))throw"Illegal argument type: channel must be a string";if(/^\/meta\//.test(e))throw"Illegal argument: cannot publish to meta channels";if(_())throw"Illegal state: already disconnected";N(t)?(r=t,t=n={}):N(n)&&(r=n,n={});var i={channel:e,data:t,_callback:r},s=this._mixin(!1,{},n,i);W(s)},this.getStatus=function(){return o},this.isDisconnected=_,this.setBackoffIncrement=function(e){S.backoffIncrement=e},this.getBackoffIncrement=function(){return S.backoffIncrement},this.getBackoffPeriod=function(){return p},this.setLogLevel=function(e){S.logLevel=e},this.registerExtension=function(e,t){if(arguments.length<2)throw"Illegal arguments number: required 2, got "+arguments.length;if(!T(e))throw"Illegal argument type: extension name must be a string";var n=!1;for(var r=0;r<v.length;++r){var i=v[r];if(i.name===e){n=!0;break}}return n?(this._info("Could not register extension with name",e,"since another extension with the same name already exists"),!1):(v.push({name:e,extension:t}),this._debug("Registered extension",e),N(t.registered)&&t.registered(e,this),!0)},this.unregisterExtension=function(e){if(!T(e))throw"Illegal argument type: extension name must be a string";var t=!1;for(var n=0;n<v.length;++n){var r=v[n];if(r.name===e){v.splice(n,1),t=!0,this._debug("Unregistered extension",e);var i=r.extension;N(i.unregistered)&&i.unregistered();break}}return t},this.getExtension=function(e){for(var t=0;t<v.length;++t){var n=v[t];if(n.name===e)return n.extension}return null},this.getName=function(){return n},this.getClientId=function(){return a},this.getURL=function(){if(s&&typeof S.urls=="object"){var e=S.urls[s.getType()];if(e)return e}return S.url},this.getTransport=function(){return s},this.getConfiguration=function(){return this._mixin(!0,{},S)},this.getAdvice=function(){return this._mixin(!0,{},m)},org.cometd.WebSocket=window.WebSocket},typeof define=="function"&&define.amd&&define([],function(){return org.cometd});
}(window.genesys.wwe.lib.require, window.genesys.wwe.lib.requirejs, window.genesys.wwe.lib.define));